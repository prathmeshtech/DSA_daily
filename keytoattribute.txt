import React, { useEffect } from "react";
import { Grid } from "@material-ui/core";
import { useDispatch, useSelector } from "react-redux";

import { AppSwitch } from "components/common";
import { getScraperDataValue, scraperDataChange } from "store/slices/scraper";

const name = "scraper_params.key_to_attribute_mapping";
export default function KeyToAttributeMappingSwitch() {
  const dispatch = useDispatch();
  const key_to_attribute_mapping = useSelector(getScraperDataValue(name));
  const type = useSelector(getScraperDataValue("type"));

  useEffect(() => {
    if (type === "HTML" && typeof key_to_attribute_mapping === "undefined")
      handleToggle({
        target: {
          name,
          checked: true,
        },
      });
  }, [type, key_to_attribute_mapping]);

  const handleToggle = (e) => {
    dispatch({
      type: scraperDataChange.type,
      payload: {
        name: e.target.name,
        value: e.target.checked,
      },
    });
  };

  return (
    <>
    {/*  */}
      {["HTML", "File Based", "Scrape From File"] && (
        <Grid item xs={12} md={8}>
          <AppSwitch
            name={name}
            label="Key to attribute mapping"
            value={key_to_attribute_mapping ? true : false}
            onChange={handleToggle}
          />
        </Grid>
      )}
    </>
  );
}
